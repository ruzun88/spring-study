# 의존 관계 자동 주입

## 의존관계 주입 방법
### 생성자 주입
- 생성자를 통해 의존 관계를 주입 받는 방법
- 생성자 호출 시점에 딱 한번 호출 되는 것이 보장된다.
- 불변, 필수 의존관계에 사용한다.
- 생성자가 딱 하나 있으면, @Autowired를 쓰지 않아도 자동 매핑 해준다. (빈 일 경우만)

### 수정자 주입
- setter Method에 @Autowired를 붙이면 빈 주입을 해줌
- 선택적, 변경 가능성 있는 경우 사용
- 주입 대상이 없어도 동작하게 하려면, @Autowired(required = false)로 쓴다.

### 필드 주입
- 빈이 되는 필드 변수에 @Autowired를 사용
``` java
@Autowired
private MemberRepository memberRepository;
```
- 예전에 많이 썼었으나, 외부에서 변경이 불가능하다는 문제점이 있어 안티패턴임
- DI 프레임워크가 없으면, 아무것도 할 수 없다.
- 스프링 컨테이너 없이는 테스트도 못한다는 `치명적 약점`!

### 일반 메서드 주입
- 일반적으로 잘 사용하지 않는다.
- 일반 자바 코드에서 @Autowired를 해도 동작 안함
- 스프링 컨테이너가 관리하는 빈이어야 정상적으로 주입이 가능하다.

## 옵션 처리
- 스프링 빈이 없어도 동작해야 할 때, @Autowired를 사용하면 기본적으로 오류가 난다.
- @Autowired(required=false)

## 생성자 주입을 써라!
- 불변, 누락을 방지할 수 있다.
- final 키워드를 쓸 수 있다는 장점이 있다. 생성자나 초기값으로만 할당할 수 있게 만드는 좋은 키워드. 컴파일 시점에 오류를 확인할 수 있다.
- 다른 방식은 final 키워드 사용할 수 없음!

## 롬복과 최신 트렌드
- 생성자 주입이 좋은데, 안좋은 점이 코드가 많아진다.
- lombok의 RequiredArgumentConstructor는 final 키워드가 붙은 녀석을 가지고 생성자를 만들어준다.

## 조회할 빈이 2개 이상일 때
- 빈이 2개 이상이면, 어떤 것으로 주입해야하는지 모르기 때문에 NoUniqueBeanDefinitionException 오류가 발생한다.
- 스프링 빈을 수동 등록해서 문제를 해결해도 되나, 그러면 DIP 위반임

### 해결방법
#### @Autowired 필드명 매칭
동일한 타입 여러 빈이 있으면, 필드 명이나 파라미터 명을 비교하여 이름이 똑같은 녀석을 가져온다.
#### @Qualifier => @Qualifier 끼리 매칭 => 빈 이름 배칭
추가 구분자를 붙여주는 방법임. 파라명은 그대로 두고, 빈에 별도의 이름을 등록해 줌.
#### @Primary 사용
자주 사용하는 녀석
- 우선순위를 지정함
- 여러개의 Bean이 있으면 Primary가 지정된 녀석이 먼저 매핑된다.

#### Qualifier와 Primary의 우선순위?
Qualifier는 세세하게 다 지정을 해준다. 이 녀석이 우선순위가 더 높다.